# Протокол `/sa` (Продовження сесії)

Цей протокол використовується для продовження відкритої теми.

**Тригер:** Команда `/sa "коментар"` від користувача.
**Семантика:** `/sa` продовжує активну сесію, зберігаючи логічний зв'язок з контекстом.

## Твої дії (Формування JSON для `memory_bridge.py`)

Ти маєш згенерувати JSON та додати його до існуючої гілки діалогу.

1.  **Вкажи Сесію:** Додай блок `session` лише з поточним `id`.
2.  **Створи вузол `:Feedback`** з текстом коментаря користувача.
3.  **Створи вузол `:Response`** з ПОВНИМ текстом твоєї відповіді.
4.  **Створи вузол `:Analysis`** (самоаналіз свого попереднього розуміння та нової інформації). Включає `verdict`, `rules_used`, `errors`, `lessons`.
5.  **Витягни сутності (`:Entity`):** ОБОВ'ЯЗКОВО! Проаналізуй поточний обмін репліками та витягни або онови **УСІ** релевантні сутності (не лише нові, а й ті що вже згадувалися), щоб зв'язати їх з новими вузлами.
6.  **Налаштуй Зв'язки (`relations`):**
    *   Всі нові вузли `PART_OF` поточна Session.
    *   Feedback `FEEDBACK_ON` попередній вузол (Response або Analysis).
    *   Response `RESPONDS_TO` Feedback.
    *   Analysis `ANALYZES` Response.
    *   Feedback, Response, Analysis `MENTIONS` Entity.
7.  **Налаштуй Хронологію (`chronology`):**
    *   Вкажи точний час (`time`).
    *   Створи `next_links`:
        *   Від попереднього останнього вузла (`last_event_id` сесії) до Feedback.
        *   Від Feedback до Response.
        *   Від Response до Analysis.
    *   Онови `last_event_id` на ID твого Analysis.

**Виконання:** Передай JSON скрипту `memory_bridge.py` через `run_command` та поверни користувачу підтвердження "✅ Артефакт збережено [ID вузлів]".

> [!IMPORTANT]
> **Очищення:** Якщо використовувався тимчасовий файл, видали його одразу після завершення `run_command`.
